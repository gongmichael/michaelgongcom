<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Michael">

    <title>Michael&#39;s Hugo Learn</title>
    

    
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    
    <link href="https://gongmichael.github.io/michaelgongcom/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    
    
    <link href="https://gongmichael.github.io/michaelgongcom/vendor/magnific-popup/magnific-popup.css" rel="stylesheet">

    
    <link href="https://gongmichael.github.io/michaelgongcom/css/creative.css" rel="stylesheet">
    <link href="https://gongmichael.github.io/michaelgongcom/css/tweak.css" rel="stylesheet">

    <script type="text/javascript" src="https://cdn.rawgit.com/pcooksey/bibtex-js/ef59e62c/src/bibtex_js.js"></script>
    <bibtex src="https://gongmichael.github.io/michaelgongcom/reference.bib"></bibtex>


    <base href="https://gongmichael.github.io/michaelgongcom/">
    

    <meta name="generator" content="Hugo 0.55.6" />
    <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
</head>
<body id="page-top">
    
        
        
        <div class="content">
            
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="genNav">
    <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="#page-top">Michael Gong</a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ml-auto">
                
                <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="#">Home</a>
                </li>
                <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="#about">About me</a>
                </li>
                <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="/michaelgongcom/blogs">Blogs</a>
                </li>
                <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="#research">Moments</a>
                </li>
                <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="/michaelgongcom/imvolsurf">IVS via DFMX</a>
                            <a class="dropdown-item" href="#">IVS via DPCP</a>
                            <a class="dropdown-item" href="#">IVS via Deep Learning</a>
                        </div>
                </li>
            </ul>
        </div>
    </div>
</nav>
    <section class="container post">
  <div class="my-auto">
    <h2 class="mb-0"><span class="text-primary">Models with DPCP</span></h2>
    <span class="text-info">September 18, 2018 | Michael Gong</span>
    <ul class="tags">
    
      <li><a class="tag" href="/michaelgongcom/tags/unicorn">Unicorn</a></li>
    
      <li><a class="tag" href="/michaelgongcom/tags/jquery">jQuery</a></li>
    
      <li><a class="tag" href="/michaelgongcom/tags/rest-apis">REST APIs</a></li>
    
      <li><a class="tag" href="/michaelgongcom/tags/bamboo">Bamboo</a></li>
    
      <li><a class="tag" href="/michaelgongcom/tags/json">JSON</a></li>
    
</ul>

    
    <br classmy-4>
    

<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">numpy</span> <span style="color:#069;font-weight:bold">as</span> <span style="color:#0cf;font-weight:bold">np</span>
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">pandas</span> <span style="color:#069;font-weight:bold">as</span> <span style="color:#0cf;font-weight:bold">pd</span>
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">itertools</span> <span style="color:#069;font-weight:bold">as</span> <span style="color:#0cf;font-weight:bold">it</span> 
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">gc</span> 
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">sys</span><span style="color:#555">,</span><span style="color:#0cf;font-weight:bold">os</span> 
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">yaml</span>
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">matplotlib.pyplot</span> <span style="color:#069;font-weight:bold">as</span> <span style="color:#0cf;font-weight:bold">plt</span>
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">multiprocessing</span> <span style="color:#069;font-weight:bold">as</span> <span style="color:#0cf;font-weight:bold">mp</span>
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">warnings</span>; warnings<span style="color:#555">.</span>simplefilter(<span style="color:#c30">&#39;ignore&#39;</span>)
pd<span style="color:#555">.</span>set_option(<span style="color:#c30">&#39;display.float_format&#39;</span>, <span style="color:#c30">&#39;{: 0.2f}&#39;</span><span style="color:#555">.</span>format)
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">statsmodels.api</span> <span style="color:#069;font-weight:bold">as</span> <span style="color:#0cf;font-weight:bold">sm</span> 
<span style="color:#555">%</span>matplotlib inline
<span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">tostr</span>(num,pad<span style="color:#555">=</span><span style="color:#f60">3</span>):
    num <span style="color:#555">=</span> <span style="color:#366">str</span>(num)
    period_chunks <span style="color:#555">=</span> num<span style="color:#555">.</span>split(<span style="color:#c30">&#39;.&#39;</span>)
    <span style="color:#069;font-weight:bold">if</span> <span style="color:#366">len</span>(period_chunks) <span style="color:#555">==</span> <span style="color:#f60">2</span>:
        deci <span style="color:#555">=</span> period_chunks[<span style="color:#f60">1</span>]
        <span style="color:#069;font-weight:bold">if</span> <span style="color:#366">len</span>(deci) <span style="color:#555">&lt;</span> pad:
            deci <span style="color:#555">=</span> deci<span style="color:#555">.</span>ljust(pad,<span style="color:#c30">&#34;0&#34;</span>)
        num <span style="color:#555">=</span> period_chunks[<span style="color:#f60">0</span>] <span style="color:#555">+</span> <span style="color:#c30">&#34;.&#34;</span> <span style="color:#555">+</span> deci 
    <span style="color:#069;font-weight:bold">return</span> num </code></pre></div>
<h1 id="1-models-with-dpcp">1. Models with DPCP</h1>

<p>\begin{equation}\label{eq:vecmpcp}
    \begin{bmatrix}
        \Delta\epsilon^{PO}_{i,t} \ \Delta\epsilon^{PI}_{i,t}\ \Delta\epsilon^{CO}_{i,t}\ \Delta\epsilon^{CI}_{i,t}
    \end{bmatrix} =
    \begin{bmatrix}
        q^{PO}_{i}DPCP_{i,t-1} \ q^{PI}_{i}DPCP_{i,t-1}\ q^{CO}_{i}DPCP_{i,t-1}\ q^{CI}_{i}DPCP_{i,t-1}
    \end{bmatrix} +
    \sum_{k=1}^M \begin{bmatrix}
        p^{PO}_{k,i}\Delta\epsilon^{PO}_{i,t-k} \ p^{PI}_{k,i}\Delta\epsilon^{PI}_{i,t-k}\ p^{CO}_{k,i}\Delta\epsilon^{CO}_{i,t-k}\ p^{CI}_{k,i}\Delta\epsilon^{CI}_{i,t-k}
    \end{bmatrix}+
    \begin{bmatrix}
        \eta^{PO}_{i,t} \ \eta^{PI}_{i,t}\ \eta^{CO}_{i,t}\ \eta^{CI}_{i,t}
    \end{bmatrix}
\end{equation}</p>

<h2 id="model-1">Model 1</h2>

<p>Put or call options have the same mean reversion rate.</p>

<p>$q^{PO}_{j}$ =$q^{PI}_{j}$</p>

<p>$q^{PO}_{i}=q^{PI}_{i}$ and $q^{CO}_{i}=q^{CI}_{i}$</p>

<p>$p^{PO}_{k,i}=p^{PI}_{k,i}=p^{CO}_{k,i}=p^{CI}_{k,i}=0$ for $k = 1,2,&hellip;,M$</p>

<h2 id="model-2">Model 2</h2>

<p>In or Out of money options have same mean reversion rate for both put and call.</p>

<p>$q^{PO}_{i}=q^{CO}_{i}$ and $q^{PI}_{i}=q^{CI}_{i}$</p>

<p>$p^{PO}_{k,i}=p^{PI}_{k,i}=p^{CO}_{k,i}=p^{CI}_{k,i}=0$ for $k = 1,2,&hellip;,M$</p>

<h2 id="model-3">Model 3</h2>

<p>No restrictions on $q$</p>

<p>$p^{PO}_{k,i}=p^{PI}_{k,i}=p^{CO}_{k,i}=p^{CI}_{k,i}=0$ for $k = 1,2,&hellip;,M$</p>

<h2 id="model-4">Model 4</h2>

<p>Full version of VECM, no restriction for both $q$ and $p$ (max $M$ = 5).</p>

<h1 id="2-general-time-series-model-ar-for-epsilon-i-t">2. General Time series Model (AR for $\epsilon_{i,t}$)</h1>

<p>\begin{equation}
    \begin{bmatrix}
        \epsilon^{PO}_{i,t} \ \epsilon^{PI}_{i,t}\ \epsilon^{CO}_{i,t}\ \epsilon^{CI}_{i,t}
    \end{bmatrix} =
    \sum_{k=1}^M \begin{bmatrix}
        p^{PO}_{k,i}\epsilon^{PO}_{i,t-k} \ p^{PI}_{k,i}\epsilon^{PI}_{i,t-k}\ p^{CO}_{k,i}\epsilon^{CO}_{i,t-k}\ p^{CI}_{k,i}\epsilon^{CI}_{i,t-k}
    \end{bmatrix}+
    \begin{bmatrix}
        \eta^{PO}_{i,t} \ \eta^{PI}_{i,t}\ \eta^{CO}_{i,t}\ \eta^{CI}_{i,t}
    \end{bmatrix}<br />
\end{equation}</p>

<h2 id="model-5">Model 5</h2>

<p>In or Out of money options have same mean reversion rate for both put and call.</p>

<p>$p^{PO}_{k,i}=p^{CO}_{k,i}$ and $p^{PI}_{k,i}=p^{CI}_{k,i}$</p>

<p>M =1</p>

<h2 id="model-6">Model 6</h2>

<p>Put or call options have the same mean reversion rate.</p>

<p>$p^{PO}_{k,i}=p^{PI}_{k,i}$ and $p^{CO}_{k,i}=p^{CI}_{k,i}$</p>

<p>M = 1</p>

<h2 id="model-7">Model 7</h2>

<p>No restrictions on $p$</p>

<p>M = 1</p>

<h2 id="model-8">Model 8</h2>

<p>No restriction on $p$ and $M$ (max $M$ = 5).</p>

<h1 id="3-summary-statistics-of-q-and-p">3. Summary statistics of $q$ and $p$</h1>

<h2 id="3-1-mean-and-standard-deviations">3.1 Mean and Standard Deviations</h2>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">mod <span style="color:#555">=</span> <span style="color:#c30">&#39;BG5&#39;</span>
specs <span style="color:#555">=</span> [<span style="color:#c30">&#39;model&#39;</span><span style="color:#555">+</span><span style="color:#366">str</span>(i) <span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">1</span>,<span style="color:#f60">9</span>)]
pandq <span style="color:#555">=</span> {}
<span style="color:#069;font-weight:bold">with</span> pd<span style="color:#555">.</span>HDFStore(<span style="color:#c30">&#39;PandQ.h5&#39;</span>,<span style="color:#c30">&#39;r&#39;</span>) <span style="color:#069;font-weight:bold">as</span> hdf:
    <span style="color:#069;font-weight:bold">for</span> spec <span style="color:#000;font-weight:bold">in</span> specs:
        pandq[spec] <span style="color:#555">=</span> hdf[spec][<span style="color:#c30">&#39;params&#39;</span>]
        
<span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">formuOne</span>(tmp):
    table <span style="color:#555">=</span> pd<span style="color:#555">.</span>concat(tmp)
    idx <span style="color:#555">=</span> [[<span style="color:#c30">&#39;model1&#39;</span>,<span style="color:#c30">&#39;model1&#39;</span>,<span style="color:#c30">&#39;model2&#39;</span>,<span style="color:#c30">&#39;model2&#39;</span>,<span style="color:#c30">&#39;model3&#39;</span>,<span style="color:#c30">&#39;model3&#39;</span>,<span style="color:#c30">&#39;model3&#39;</span>,<span style="color:#c30">&#39;model3&#39;</span>,<span style="color:#c30">&#39;model4&#39;</span>,<span style="color:#c30">&#39;model4&#39;</span>,<span style="color:#c30">&#39;model4&#39;</span>,<span style="color:#c30">&#39;model4&#39;</span>,],
           [<span style="color:#c30">&#39;C&#39;</span>,<span style="color:#c30">&#39;P&#39;</span>,<span style="color:#c30">&#39;I&#39;</span>,<span style="color:#c30">&#39;O&#39;</span>,<span style="color:#c30">&#39;CI&#39;</span>,<span style="color:#c30">&#39;CO&#39;</span>,<span style="color:#c30">&#39;PI&#39;</span>,<span style="color:#c30">&#39;PO&#39;</span>,<span style="color:#c30">&#39;CI&#39;</span>,<span style="color:#c30">&#39;CO&#39;</span>,<span style="color:#c30">&#39;PI&#39;</span>,<span style="color:#c30">&#39;PO&#39;</span>]]
    idx <span style="color:#555">=</span> <span style="color:#366">list</span>(<span style="color:#366">zip</span>(<span style="color:#555">*</span>idx))
    idx <span style="color:#555">=</span> pd<span style="color:#555">.</span>MultiIndex<span style="color:#555">.</span>from_tuples(idx)
    table<span style="color:#555">.</span>index<span style="color:#555">=</span>idx
    table <span style="color:#555">=</span> table[[<span style="color:#c30">&#39;PCPL1&#39;</span>,<span style="color:#c30">&#39;BG5ED2&#39;</span>,<span style="color:#c30">&#39;BG5ED3&#39;</span>,<span style="color:#c30">&#39;BG5ED4&#39;</span>,<span style="color:#c30">&#39;BG5ED5&#39;</span>]]
    table<span style="color:#555">.</span>columns <span style="color:#555">=</span> [<span style="color:#c30">&#39;q&#39;</span>,<span style="color:#c30">&#39;p1&#39;</span>,<span style="color:#c30">&#39;p2&#39;</span>,<span style="color:#c30">&#39;p3&#39;</span>,<span style="color:#c30">&#39;p4&#39;</span>]
    table1 <span style="color:#555">=</span> table<span style="color:#555">.</span><span style="color:#366">round</span>(<span style="color:#f60">3</span>)<span style="color:#555">.</span>astype(<span style="color:#366">str</span>)<span style="color:#555">.</span>replace(<span style="color:#c30">&#39;nan&#39;</span>,<span style="color:#c30">&#39;   &#39;</span>)
    <span style="color:#069;font-weight:bold">return</span> table1


<span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">formuTwo</span>(tmp):
    table <span style="color:#555">=</span> pd<span style="color:#555">.</span>concat(tmp)
    idx <span style="color:#555">=</span> [[<span style="color:#c30">&#39;model5&#39;</span>,<span style="color:#c30">&#39;model5&#39;</span>,<span style="color:#c30">&#39;model6&#39;</span>,<span style="color:#c30">&#39;model6&#39;</span>,<span style="color:#c30">&#39;model7&#39;</span>,<span style="color:#c30">&#39;model7&#39;</span>,<span style="color:#c30">&#39;model7&#39;</span>,<span style="color:#c30">&#39;model7&#39;</span>,<span style="color:#c30">&#39;model8&#39;</span>,<span style="color:#c30">&#39;model8&#39;</span>,<span style="color:#c30">&#39;model8&#39;</span>,<span style="color:#c30">&#39;model8&#39;</span>,],
           [<span style="color:#c30">&#39;C&#39;</span>,<span style="color:#c30">&#39;P&#39;</span>,<span style="color:#c30">&#39;I&#39;</span>,<span style="color:#c30">&#39;O&#39;</span>,<span style="color:#c30">&#39;CI&#39;</span>,<span style="color:#c30">&#39;CO&#39;</span>,<span style="color:#c30">&#39;PI&#39;</span>,<span style="color:#c30">&#39;PO&#39;</span>,<span style="color:#c30">&#39;CI&#39;</span>,<span style="color:#c30">&#39;CO&#39;</span>,<span style="color:#c30">&#39;PI&#39;</span>,<span style="color:#c30">&#39;PO&#39;</span>]]
    idx <span style="color:#555">=</span> <span style="color:#366">list</span>(<span style="color:#366">zip</span>(<span style="color:#555">*</span>idx))
    idx <span style="color:#555">=</span> pd<span style="color:#555">.</span>MultiIndex<span style="color:#555">.</span>from_tuples(idx)
    table<span style="color:#555">.</span>index<span style="color:#555">=</span>idx
    table <span style="color:#555">=</span> table[[<span style="color:#c30">&#39;BG5EL1&#39;</span>,<span style="color:#c30">&#39;BG5EL2&#39;</span>,<span style="color:#c30">&#39;BG5EL3&#39;</span>,<span style="color:#c30">&#39;BG5EL4&#39;</span>,<span style="color:#c30">&#39;BG5EL5&#39;</span>]]
    table<span style="color:#555">.</span>columns <span style="color:#555">=</span> [<span style="color:#c30">&#39;p1&#39;</span>,<span style="color:#c30">&#39;p2&#39;</span>,<span style="color:#c30">&#39;p3&#39;</span>,<span style="color:#c30">&#39;p4&#39;</span>,<span style="color:#c30">&#39;p5&#39;</span>]
    table2 <span style="color:#555">=</span> table<span style="color:#555">.</span><span style="color:#366">round</span>(<span style="color:#f60">3</span>)<span style="color:#555">.</span>astype(<span style="color:#366">str</span>)<span style="color:#555">.</span>replace(<span style="color:#c30">&#39;nan&#39;</span>,<span style="color:#c30">&#39;   &#39;</span>)
    <span style="color:#069;font-weight:bold">return</span> table2

mean,std <span style="color:#555">=</span> {},{}
<span style="color:#069;font-weight:bold">for</span> spec <span style="color:#000;font-weight:bold">in</span> specs:
    mean[spec] <span style="color:#555">=</span> pandq[spec]<span style="color:#555">.</span>groupby(level<span style="color:#555">=</span><span style="color:#f60">1</span>)<span style="color:#555">.</span>mean()
    std[spec] <span style="color:#555">=</span> pandq[spec]<span style="color:#555">.</span>groupby(level<span style="color:#555">=</span><span style="color:#f60">1</span>)<span style="color:#555">.</span>std()
    
tmp1,tmp2 <span style="color:#555">=</span> [],[]
<span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">1</span>,<span style="color:#f60">5</span>):
    tmp1<span style="color:#555">.</span>append(mean[<span style="color:#c30">&#39;model&#39;</span><span style="color:#555">+</span><span style="color:#366">str</span>(i)])
    tmp2<span style="color:#555">.</span>append(std[<span style="color:#c30">&#39;model&#39;</span><span style="color:#555">+</span><span style="color:#366">str</span>(i)])
    
tmp3,tmp4 <span style="color:#555">=</span> [],[]
<span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">5</span>,<span style="color:#f60">9</span>):
    tmp3<span style="color:#555">.</span>append(mean[<span style="color:#c30">&#39;model&#39;</span><span style="color:#555">+</span><span style="color:#366">str</span>(i)])
    tmp4<span style="color:#555">.</span>append(std[<span style="color:#c30">&#39;model&#39;</span><span style="color:#555">+</span><span style="color:#366">str</span>(i)])

tab1m <span style="color:#555">=</span> formuOne(tmp1)
tab1d <span style="color:#555">=</span> formuOne(tmp2)
tab2m <span style="color:#555">=</span> formuTwo(tmp3)
tab2d <span style="color:#555">=</span> formuTwo(tmp4)

tab1 <span style="color:#555">=</span> pd<span style="color:#555">.</span>DataFrame(index<span style="color:#555">=</span>tab1m<span style="color:#555">.</span>index,columns<span style="color:#555">=</span>tab1m<span style="color:#555">.</span>columns,dtype<span style="color:#555">=</span><span style="color:#366">object</span>)
tab2 <span style="color:#555">=</span> pd<span style="color:#555">.</span>DataFrame(index<span style="color:#555">=</span>tab2m<span style="color:#555">.</span>index,columns<span style="color:#555">=</span>tab2m<span style="color:#555">.</span>columns,dtype<span style="color:#555">=</span><span style="color:#366">object</span>)
<span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(tab1m<span style="color:#555">.</span>shape[<span style="color:#f60">0</span>]):
    <span style="color:#069;font-weight:bold">for</span> j <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(tab1d<span style="color:#555">.</span>shape[<span style="color:#f60">1</span>]):
        tab1<span style="color:#555">.</span>iloc[i,j] <span style="color:#555">=</span> tab1m<span style="color:#555">.</span>iloc[i,j]<span style="color:#555">+</span><span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tab1d<span style="color:#555">.</span>iloc[i,j]<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
        tab2<span style="color:#555">.</span>iloc[i,j] <span style="color:#555">=</span> tab2m<span style="color:#555">.</span>iloc[i,j]<span style="color:#555">+</span><span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tab2d<span style="color:#555">.</span>iloc[i,j]<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
tab1<span style="color:#555">.</span>iloc[:<span style="color:#f60">8</span>,<span style="color:#f60">1</span>:] <span style="color:#555">=</span> <span style="color:#c30">&#34;   &#34;</span>
tab2<span style="color:#555">.</span>iloc[:<span style="color:#f60">8</span>,<span style="color:#f60">1</span>:] <span style="color:#555">=</span> <span style="color:#c30">&#34;   &#34;</span>
<span style="color:#069;font-weight:bold">print</span>(<span style="color:#c30">&#34;Models with DPCP&#34;</span>)
tab1</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">Models with DPCP</pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>q</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
      <th>p4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">model1</th>
      <th>C</th>
      <td>1.293(0.326)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>P</th>
      <td>-1.199(0.309)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model2</th>
      <th>I</th>
      <td>0.467(0.214)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>O</th>
      <td>-0.368(0.19)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">model3</th>
      <th>CI</th>
      <td>1.417(0.327)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>CO</th>
      <td>1.036(0.341)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>PI</th>
      <td>-1.52(0.451)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>PO</th>
      <td>-1.057(0.279)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">model4</th>
      <th>CI</th>
      <td>0.568(0.156)</td>
      <td>-0.581(0.068)</td>
      <td>-0.399(0.07)</td>
      <td>-0.247(0.053)</td>
      <td>-0.121(0.039)</td>
    </tr>
    <tr>
      <th>CO</th>
      <td>0.428(0.181)</td>
      <td>-0.58(0.085)</td>
      <td>-0.393(0.088)</td>
      <td>-0.227(0.062)</td>
      <td>-0.11(0.035)</td>
    </tr>
    <tr>
      <th>PI</th>
      <td>-0.551(0.195)</td>
      <td>-0.605(0.062)</td>
      <td>-0.414(0.061)</td>
      <td>-0.255(0.046)</td>
      <td>-0.122(0.026)</td>
    </tr>
    <tr>
      <th>PO</th>
      <td>-0.398(0.121)</td>
      <td>-0.581(0.069)</td>
      <td>-0.391(0.073)</td>
      <td>-0.228(0.049)</td>
      <td>-0.113(0.031)</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#069;font-weight:bold">print</span>(<span style="color:#c30">&#34;General Time Series Model (AR for residuals)&#34;</span>)
tab2</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">General Time Series Model (AR for residuals)</pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
      <th>p4</th>
      <th>p5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">model5</th>
      <th>C</th>
      <td>0.539(0.114)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>P</th>
      <td>0.5(0.13)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model6</th>
      <th>I</th>
      <td>0.511(0.12)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>O</th>
      <td>0.534(0.127)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">model7</th>
      <th>CI</th>
      <td>0.538(0.112)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>CO</th>
      <td>0.539(0.137)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>PI</th>
      <td>0.455(0.146)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>PO</th>
      <td>0.531(0.127)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">model8</th>
      <th>CI</th>
      <td>0.263(0.058)</td>
      <td>0.189(0.031)</td>
      <td>0.152(0.015)</td>
      <td>0.12(0.019)</td>
      <td>0.11(0.033)</td>
    </tr>
    <tr>
      <th>CO</th>
      <td>0.291(0.084)</td>
      <td>0.178(0.04)</td>
      <td>0.152(0.041)</td>
      <td>0.098(0.034)</td>
      <td>0.085(0.03)</td>
    </tr>
    <tr>
      <th>PI</th>
      <td>0.243(0.068)</td>
      <td>0.176(0.032)</td>
      <td>0.139(0.02)</td>
      <td>0.108(0.017)</td>
      <td>0.091(0.02)</td>
    </tr>
    <tr>
      <th>PO</th>
      <td>0.288(0.073)</td>
      <td>0.184(0.034)</td>
      <td>0.152(0.029)</td>
      <td>0.097(0.024)</td>
      <td>0.089(0.025)</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="3-2-t-test-for-equal-mean">3.2 T test for equal mean</h2>

<p>Models with DPCP</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">scipy.stats</span> <span style="color:#069;font-weight:bold">import</span> ttest_ind

<span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">typeOneTest</span>(model,on,var):
    view <span style="color:#555">=</span> pandq[model]
    on1, on2 <span style="color:#555">=</span> on[<span style="color:#f60">0</span>], on[<span style="color:#f60">1</span>]
    s1 <span style="color:#555">=</span> view<span style="color:#555">.</span>loc[(<span style="color:#366">slice</span>(None),on1),var]<span style="color:#555">.</span><span style="color:#366">abs</span>()<span style="color:#555">.</span>values
    s2 <span style="color:#555">=</span> view<span style="color:#555">.</span>loc[(<span style="color:#366">slice</span>(None),on2),var]<span style="color:#555">.</span><span style="color:#366">abs</span>()<span style="color:#555">.</span>values
    t,p <span style="color:#555">=</span> ttest_ind(s1,s2,equal_var<span style="color:#555">=</span>True)
    <span style="color:#069;font-weight:bold">return</span> t,p

<span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">typeTwoTest</span>(model,on,var):
    view <span style="color:#555">=</span> pandq[model]
    on1, on2, on3, on4 <span style="color:#555">=</span> on[<span style="color:#f60">0</span>], on[<span style="color:#f60">1</span>],on[<span style="color:#f60">2</span>], on[<span style="color:#f60">3</span>]
    s1 <span style="color:#555">=</span> view<span style="color:#555">.</span>loc[(<span style="color:#366">slice</span>(None),on1),var]<span style="color:#555">.</span><span style="color:#366">abs</span>()<span style="color:#555">.</span>values
    s2 <span style="color:#555">=</span> view<span style="color:#555">.</span>loc[(<span style="color:#366">slice</span>(None),on2),var]<span style="color:#555">.</span><span style="color:#366">abs</span>()<span style="color:#555">.</span>values
    s3 <span style="color:#555">=</span> view<span style="color:#555">.</span>loc[(<span style="color:#366">slice</span>(None),on3),var]<span style="color:#555">.</span><span style="color:#366">abs</span>()<span style="color:#555">.</span>values
    s4 <span style="color:#555">=</span> view<span style="color:#555">.</span>loc[(<span style="color:#366">slice</span>(None),on4),var]<span style="color:#555">.</span><span style="color:#366">abs</span>()<span style="color:#555">.</span>values
    t1,p1 <span style="color:#555">=</span> ttest_ind(s1,s2,equal_var<span style="color:#555">=</span>True)
    t2,p2 <span style="color:#555">=</span> ttest_ind(s3,s4,equal_var<span style="color:#555">=</span>True)
    <span style="color:#069;font-weight:bold">return</span> t1,p1,t2,p2

ttest <span style="color:#555">=</span> {}
ttest[<span style="color:#c30">&#39;model1&#39;</span>] <span style="color:#555">=</span> typeOneTest(<span style="color:#c30">&#39;model1&#39;</span>,[<span style="color:#c30">&#39;P&#39;</span>,<span style="color:#c30">&#39;C&#39;</span>],<span style="color:#c30">&#39;PCPL1&#39;</span>)
ttest[<span style="color:#c30">&#39;model2&#39;</span>] <span style="color:#555">=</span> typeOneTest(<span style="color:#c30">&#39;model2&#39;</span>,[<span style="color:#c30">&#39;I&#39;</span>,<span style="color:#c30">&#39;O&#39;</span>],<span style="color:#c30">&#39;PCPL1&#39;</span>)
ttest[<span style="color:#c30">&#39;model3&#39;</span>] <span style="color:#555">=</span> typeTwoTest(<span style="color:#c30">&#39;model3&#39;</span>,[<span style="color:#c30">&#39;PI&#39;</span>,<span style="color:#c30">&#39;PO&#39;</span>,<span style="color:#c30">&#39;CI&#39;</span>,<span style="color:#c30">&#39;CO&#39;</span>],<span style="color:#c30">&#39;PCPL1&#39;</span>)
tmp <span style="color:#555">=</span> []
<span style="color:#069;font-weight:bold">for</span> col <span style="color:#000;font-weight:bold">in</span> pandq[<span style="color:#c30">&#39;model4&#39;</span>]<span style="color:#555">.</span>columns:
    tmp<span style="color:#555">.</span>append(typeTwoTest(<span style="color:#c30">&#39;model4&#39;</span>,[<span style="color:#c30">&#39;PI&#39;</span>,<span style="color:#c30">&#39;PO&#39;</span>,<span style="color:#c30">&#39;CI&#39;</span>,<span style="color:#c30">&#39;CO&#39;</span>],col))
ttest[<span style="color:#c30">&#39;model4&#39;</span>] <span style="color:#555">=</span> tmp

ttest[<span style="color:#c30">&#39;model5&#39;</span>] <span style="color:#555">=</span> typeOneTest(<span style="color:#c30">&#39;model5&#39;</span>,[<span style="color:#c30">&#39;P&#39;</span>,<span style="color:#c30">&#39;C&#39;</span>],<span style="color:#c30">&#39;BG5EL1&#39;</span>)
ttest[<span style="color:#c30">&#39;model6&#39;</span>] <span style="color:#555">=</span> typeOneTest(<span style="color:#c30">&#39;model6&#39;</span>,[<span style="color:#c30">&#39;I&#39;</span>,<span style="color:#c30">&#39;O&#39;</span>],<span style="color:#c30">&#39;BG5EL1&#39;</span>)
ttest[<span style="color:#c30">&#39;model7&#39;</span>] <span style="color:#555">=</span> typeTwoTest(<span style="color:#c30">&#39;model7&#39;</span>,[<span style="color:#c30">&#39;PI&#39;</span>,<span style="color:#c30">&#39;PO&#39;</span>,<span style="color:#c30">&#39;CI&#39;</span>,<span style="color:#c30">&#39;CO&#39;</span>],<span style="color:#c30">&#39;BG5EL1&#39;</span>)
tmp <span style="color:#555">=</span> []
<span style="color:#069;font-weight:bold">for</span> col <span style="color:#000;font-weight:bold">in</span> pandq[<span style="color:#c30">&#39;model8&#39;</span>]<span style="color:#555">.</span>columns:
    tmp<span style="color:#555">.</span>append(typeTwoTest(<span style="color:#c30">&#39;model8&#39;</span>,[<span style="color:#c30">&#39;PI&#39;</span>,<span style="color:#c30">&#39;PO&#39;</span>,<span style="color:#c30">&#39;CI&#39;</span>,<span style="color:#c30">&#39;CO&#39;</span>],col))
ttest[<span style="color:#c30">&#39;model8&#39;</span>] <span style="color:#555">=</span> tmp

idx <span style="color:#555">=</span> [[<span style="color:#c30">&#39;model1&#39;</span>,<span style="color:#c30">&#39;model2&#39;</span>,<span style="color:#c30">&#39;model3&#39;</span>,<span style="color:#c30">&#39;model3&#39;</span>,<span style="color:#c30">&#39;model4&#39;</span>,<span style="color:#c30">&#39;model4&#39;</span>,],
       [<span style="color:#c30">&#39;PvC&#39;</span>,<span style="color:#c30">&#39;IvO&#39;</span>,<span style="color:#c30">&#39;PIvPO&#39;</span>,<span style="color:#c30">&#39;CIvCO&#39;</span>,<span style="color:#c30">&#39;PIvPO&#39;</span>,<span style="color:#c30">&#39;CIvCO&#39;</span>]]
idx <span style="color:#555">=</span> <span style="color:#366">list</span>(<span style="color:#366">zip</span>(<span style="color:#555">*</span>idx))
idx <span style="color:#555">=</span> pd<span style="color:#555">.</span>MultiIndex<span style="color:#555">.</span>from_tuples(idx)
tabt1 <span style="color:#555">=</span> pd<span style="color:#555">.</span>DataFrame(index<span style="color:#555">=</span>idx,columns<span style="color:#555">=</span>[<span style="color:#c30">&#39;q&#39;</span>,<span style="color:#c30">&#39;p1&#39;</span>,<span style="color:#c30">&#39;p2&#39;</span>,<span style="color:#c30">&#39;p3&#39;</span>,<span style="color:#c30">&#39;p4&#39;</span>],dtype<span style="color:#555">=</span><span style="color:#366">object</span>)
tabt1<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model1&#39;</span>,<span style="color:#c30">&#39;PvC&#39;</span>),<span style="color:#c30">&#39;q&#39;</span>] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model1&#39;</span>][<span style="color:#f60">0</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model1&#39;</span>][<span style="color:#f60">1</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
tabt1<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model2&#39;</span>,<span style="color:#c30">&#39;IvO&#39;</span>),<span style="color:#c30">&#39;q&#39;</span>] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model2&#39;</span>][<span style="color:#f60">0</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model2&#39;</span>][<span style="color:#f60">1</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
tabt1<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model3&#39;</span>,<span style="color:#c30">&#39;PIvPO&#39;</span>),<span style="color:#c30">&#39;q&#39;</span>] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model3&#39;</span>][<span style="color:#f60">0</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model3&#39;</span>][<span style="color:#f60">1</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
tabt1<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model3&#39;</span>,<span style="color:#c30">&#39;CIvCO&#39;</span>),<span style="color:#c30">&#39;q&#39;</span>] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model3&#39;</span>][<span style="color:#f60">2</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model3&#39;</span>][<span style="color:#f60">3</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
<span style="color:#069;font-weight:bold">for</span> i, col <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">enumerate</span>([<span style="color:#c30">&#39;q&#39;</span>,<span style="color:#c30">&#39;p1&#39;</span>,<span style="color:#c30">&#39;p2&#39;</span>,<span style="color:#c30">&#39;p3&#39;</span>,<span style="color:#c30">&#39;p4&#39;</span>]):
    tabt1<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model4&#39;</span>,<span style="color:#c30">&#39;PIvPO&#39;</span>),col] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model4&#39;</span>][i][<span style="color:#f60">0</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model4&#39;</span>][i][<span style="color:#f60">1</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
    tabt1<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model4&#39;</span>,<span style="color:#c30">&#39;CIvCO&#39;</span>),col] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model4&#39;</span>][i][<span style="color:#f60">2</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model4&#39;</span>][i][<span style="color:#f60">3</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>

idx <span style="color:#555">=</span> [[<span style="color:#c30">&#39;model5&#39;</span>,<span style="color:#c30">&#39;model6&#39;</span>,<span style="color:#c30">&#39;model7&#39;</span>,<span style="color:#c30">&#39;model7&#39;</span>,<span style="color:#c30">&#39;model8&#39;</span>,<span style="color:#c30">&#39;model8&#39;</span>,],
       [<span style="color:#c30">&#39;PvC&#39;</span>,<span style="color:#c30">&#39;IvO&#39;</span>,<span style="color:#c30">&#39;PIvPO&#39;</span>,<span style="color:#c30">&#39;CIvCO&#39;</span>,<span style="color:#c30">&#39;PIvPO&#39;</span>,<span style="color:#c30">&#39;CIvCO&#39;</span>]]
idx <span style="color:#555">=</span> <span style="color:#366">list</span>(<span style="color:#366">zip</span>(<span style="color:#555">*</span>idx))
idx <span style="color:#555">=</span> pd<span style="color:#555">.</span>MultiIndex<span style="color:#555">.</span>from_tuples(idx)
tabt2 <span style="color:#555">=</span> pd<span style="color:#555">.</span>DataFrame(index<span style="color:#555">=</span>idx,columns<span style="color:#555">=</span>[<span style="color:#c30">&#39;p1&#39;</span>,<span style="color:#c30">&#39;p2&#39;</span>,<span style="color:#c30">&#39;p3&#39;</span>,<span style="color:#c30">&#39;p4&#39;</span>,<span style="color:#c30">&#39;p5&#39;</span>],dtype<span style="color:#555">=</span><span style="color:#366">object</span>)
tabt2<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model5&#39;</span>,<span style="color:#c30">&#39;PvC&#39;</span>),<span style="color:#c30">&#39;p1&#39;</span>] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model5&#39;</span>][<span style="color:#f60">0</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model5&#39;</span>][<span style="color:#f60">1</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
tabt2<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model6&#39;</span>,<span style="color:#c30">&#39;IvO&#39;</span>),<span style="color:#c30">&#39;p1&#39;</span>] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model6&#39;</span>][<span style="color:#f60">0</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model6&#39;</span>][<span style="color:#f60">1</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
tabt2<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model7&#39;</span>,<span style="color:#c30">&#39;PIvPO&#39;</span>),<span style="color:#c30">&#39;p1&#39;</span>] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model7&#39;</span>][<span style="color:#f60">0</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model7&#39;</span>][<span style="color:#f60">1</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
tabt2<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model7&#39;</span>,<span style="color:#c30">&#39;CIvCO&#39;</span>),<span style="color:#c30">&#39;p1&#39;</span>] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model7&#39;</span>][<span style="color:#f60">2</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model7&#39;</span>][<span style="color:#f60">3</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
<span style="color:#069;font-weight:bold">for</span> i, col <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">enumerate</span>([<span style="color:#c30">&#39;p1&#39;</span>,<span style="color:#c30">&#39;p2&#39;</span>,<span style="color:#c30">&#39;p3&#39;</span>,<span style="color:#c30">&#39;p4&#39;</span>,<span style="color:#c30">&#39;p5&#39;</span>]):
    tabt2<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model8&#39;</span>,<span style="color:#c30">&#39;PIvPO&#39;</span>),col] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model8&#39;</span>][i][<span style="color:#f60">0</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model8&#39;</span>][i][<span style="color:#f60">1</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
    tabt2<span style="color:#555">.</span>loc[(<span style="color:#c30">&#39;model8&#39;</span>,<span style="color:#c30">&#39;CIvCO&#39;</span>),col] <span style="color:#555">=</span> tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model8&#39;</span>][i][<span style="color:#f60">2</span>],<span style="color:#f60">3</span>)) <span style="color:#555">+</span> <span style="color:#c30">&#34;(&#34;</span><span style="color:#555">+</span>tostr(np<span style="color:#555">.</span><span style="color:#366">round</span>(ttest[<span style="color:#c30">&#39;model8&#39;</span>][i][<span style="color:#f60">3</span>],<span style="color:#f60">3</span>))<span style="color:#555">+</span><span style="color:#c30">&#34;)&#34;</span>
tabt1<span style="color:#555">.</span>iloc[:<span style="color:#f60">4</span>,<span style="color:#f60">1</span>:] <span style="color:#555">=</span> <span style="color:#c30">&#34;   &#34;</span>
tabt2<span style="color:#555">.</span>iloc[:<span style="color:#f60">4</span>,<span style="color:#f60">1</span>:] <span style="color:#555">=</span> <span style="color:#c30">&#34;   &#34;</span>
tabt1</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">Models with DPCP</pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>q</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
      <th>p4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>model1</th>
      <th>PvC</th>
      <td>-2.040(0.043)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>model2</th>
      <th>IvO</th>
      <td>3.122(0.002)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model3</th>
      <th>PIvPO</th>
      <td>8.561(0.000)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>CIvCO</th>
      <td>7.905(0.000)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model4</th>
      <th>PIvPO</th>
      <td>6.553(0.000)</td>
      <td>2.567(0.011)</td>
      <td>2.315(0.022)</td>
      <td>3.985(0.000)</td>
      <td>2.103(0.037)</td>
    </tr>
    <tr>
      <th>CIvCO</th>
      <td>5.742(0.000)</td>
      <td>0.097(0.923)</td>
      <td>0.558(0.578)</td>
      <td>2.432(0.016)</td>
      <td>2.089(0.038)</td>
    </tr>
  </tbody>
</table>
</div>

<p>General Time Series Model (AR for residuals)</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tabt2</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">General Time Series Model (AR for residuals)</pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
      <th>p4</th>
      <th>p5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>model5</th>
      <th>PvC</th>
      <td>-2.198(0.029)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>model6</th>
      <th>IvO</th>
      <td>-1.295(0.197)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model7</th>
      <th>PIvPO</th>
      <td>-3.877(0.000)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>CIvCO</th>
      <td>-0.056(0.955)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">model8</th>
      <th>PIvPO</th>
      <td>-4.457(0.000)</td>
      <td>-1.583(0.115)</td>
      <td>-3.752(0.000)</td>
      <td>3.684(0.000)</td>
      <td>0.401(0.689)</td>
    </tr>
    <tr>
      <th>CIvCO</th>
      <td>-2.690(0.008)</td>
      <td>2.152(0.033)</td>
      <td>-0.093(0.926)</td>
      <td>5.583(0.000)</td>
      <td>5.490(0.000)</td>
    </tr>
  </tbody>
</table>
</div>

<h1 id="4-in-sample-fit">4. In-sample Fit</h1>

<h2 id="4-1-rmse-over-ivs">4.1 RMSE over IVS</h2>

<p>RMSE over entire surface</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#069;font-weight:bold">with</span> pd<span style="color:#555">.</span>HDFStore(<span style="color:#c30">&#39;ISFit.h5&#39;</span>,<span style="color:#c30">&#39;r&#39;</span>) <span style="color:#069;font-weight:bold">as</span> hdf:
    data <span style="color:#555">=</span> hdf[<span style="color:#c30">&#39;ISFit&#39;</span>]
models <span style="color:#555">=</span> [<span style="color:#c30">&#39;BG5&#39;</span>]
modsF <span style="color:#555">=</span> [mod <span style="color:#555">+</span> <span style="color:#c30">&#39;N&#39;</span> <span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> models]
modsF <span style="color:#555">+=</span> [mod <span style="color:#555">+</span> <span style="color:#c30">&#39;C&#39;</span> <span style="color:#555">+</span> <span style="color:#366">str</span>(i) <span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> models <span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">1</span>,<span style="color:#f60">9</span>)]
maturG <span style="color:#555">=</span> [<span style="color:#c30">&#39;short&#39;</span>,<span style="color:#c30">&#39;medium&#39;</span>,<span style="color:#c30">&#39;long&#39;</span>]
deltaG <span style="color:#555">=</span> [<span style="color:#c30">&#39;DOTMP&#39;</span>,<span style="color:#c30">&#39;OTMP&#39;</span>,<span style="color:#c30">&#39;ATMP&#39;</span>,<span style="color:#c30">&#39;ITMP&#39;</span>,<span style="color:#c30">&#39;DITMP&#39;</span>,<span style="color:#c30">&#39;DITMC&#39;</span>,<span style="color:#c30">&#39;ITMC&#39;</span>,<span style="color:#c30">&#39;ATMC&#39;</span>,<span style="color:#c30">&#39;OTMC&#39;</span>,<span style="color:#c30">&#39;DOTMC&#39;</span>]
<span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> modsF:
    data[mod] <span style="color:#555">=</span> data<span style="color:#555">.</span><span style="color:#366">eval</span>(<span style="color:#c30">&#34;(imvol-</span><span style="color:#a00">%s</span><span style="color:#c30">)**2&#34;</span><span style="color:#555">%</span>(mod))
rmse <span style="color:#555">=</span> np<span style="color:#555">.</span>sqrt(data<span style="color:#555">.</span>groupby([<span style="color:#c30">&#39;ticker&#39;</span>,<span style="color:#c30">&#39;date&#39;</span>,<span style="color:#c30">&#39;delta_groups&#39;</span>,<span style="color:#c30">&#39;mat_groups&#39;</span>])[modsF]<span style="color:#555">.</span>mean())
tab <span style="color:#555">=</span> rmse<span style="color:#555">.</span>mean(level<span style="color:#555">=</span>[<span style="color:#f60">2</span>,<span style="color:#f60">3</span>])<span style="color:#555">*</span><span style="color:#f60">100</span>
<span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> modsF[<span style="color:#f60">1</span>:]:
    tab[mod] <span style="color:#555">=</span> (tab[mod]<span style="color:#555">-</span>tab[<span style="color:#c30">&#39;BG5N&#39;</span>])<span style="color:#555">/</span>tab[<span style="color:#c30">&#39;BG5N&#39;</span>]
tabs <span style="color:#555">=</span> tab<span style="color:#555">.</span><span style="color:#366">round</span>(<span style="color:#f60">2</span>)<span style="color:#555">.</span>astype(<span style="color:#366">str</span>)
tabs[<span style="color:#c30">&#39;BG5C4&#39;</span>] <span style="color:#555">=</span> tabs[<span style="color:#c30">&#39;BG5C4&#39;</span>] <span style="color:#555">+</span> <span style="color:#c30">&#39;*&#39;</span>
tabs<span style="color:#555">.</span>T[deltaG]<span style="color:#555">.</span>T</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">RMSE over entire surface</pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>BG5N</th>
      <th>BG5C1</th>
      <th>BG5C2</th>
      <th>BG5C3</th>
      <th>BG5C4</th>
      <th>BG5C5</th>
      <th>BG5C6</th>
      <th>BG5C7</th>
      <th>BG5C8</th>
    </tr>
    <tr>
      <th>delta_groups</th>
      <th>mat_groups</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">DOTMP</th>
      <th>long</th>
      <td>2.01</td>
      <td>-0.09</td>
      <td>-0.17</td>
      <td>-0.12</td>
      <td>-0.27*</td>
      <td>-0.2</td>
      <td>-0.2</td>
      <td>-0.2</td>
      <td>-0.26</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>2.43</td>
      <td>-0.12</td>
      <td>-0.16</td>
      <td>-0.14</td>
      <td>-0.26*</td>
      <td>-0.19</td>
      <td>-0.2</td>
      <td>-0.2</td>
      <td>-0.23</td>
    </tr>
    <tr>
      <th>short</th>
      <td>2.92</td>
      <td>-0.13</td>
      <td>-0.14</td>
      <td>-0.15</td>
      <td>-0.22*</td>
      <td>-0.16</td>
      <td>-0.16</td>
      <td>-0.16</td>
      <td>-0.18</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">OTMP</th>
      <th>long</th>
      <td>1.19</td>
      <td>-0.16</td>
      <td>-0.18</td>
      <td>-0.17</td>
      <td>-0.29*</td>
      <td>-0.22</td>
      <td>-0.22</td>
      <td>-0.22</td>
      <td>-0.27</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1.35</td>
      <td>-0.17</td>
      <td>-0.15</td>
      <td>-0.17</td>
      <td>-0.27*</td>
      <td>-0.2</td>
      <td>-0.2</td>
      <td>-0.2</td>
      <td>-0.23</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.98</td>
      <td>-0.27</td>
      <td>-0.24</td>
      <td>-0.27</td>
      <td>-0.32*</td>
      <td>-0.23</td>
      <td>-0.24</td>
      <td>-0.24</td>
      <td>-0.25</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ATMP</th>
      <th>long</th>
      <td>0.77</td>
      <td>-0.27</td>
      <td>-0.33</td>
      <td>-0.28</td>
      <td>-0.41*</td>
      <td>-0.31</td>
      <td>-0.32</td>
      <td>-0.32</td>
      <td>-0.37</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>0.93</td>
      <td>-0.38</td>
      <td>-0.4</td>
      <td>-0.39</td>
      <td>-0.45*</td>
      <td>-0.35</td>
      <td>-0.36</td>
      <td>-0.36</td>
      <td>-0.39</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.3</td>
      <td>-0.32</td>
      <td>-0.31</td>
      <td>-0.33</td>
      <td>-0.37*</td>
      <td>-0.3</td>
      <td>-0.31</td>
      <td>-0.31</td>
      <td>-0.29</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ITMP</th>
      <th>long</th>
      <td>0.91</td>
      <td>-0.34</td>
      <td>-0.36</td>
      <td>-0.31</td>
      <td>-0.46*</td>
      <td>-0.34</td>
      <td>-0.35</td>
      <td>-0.32</td>
      <td>-0.41</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1.01</td>
      <td>-0.4</td>
      <td>-0.39</td>
      <td>-0.37</td>
      <td>-0.48*</td>
      <td>-0.36</td>
      <td>-0.36</td>
      <td>-0.34</td>
      <td>-0.4</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.33</td>
      <td>-0.35</td>
      <td>-0.28</td>
      <td>-0.33</td>
      <td>-0.39*</td>
      <td>-0.31</td>
      <td>-0.31</td>
      <td>-0.29</td>
      <td>-0.31</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">DITMP</th>
      <th>long</th>
      <td>1.21</td>
      <td>-0.09</td>
      <td>0.01</td>
      <td>-0.07</td>
      <td>-0.22*</td>
      <td>-0.16</td>
      <td>-0.16</td>
      <td>-0.16</td>
      <td>-0.21</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1.39</td>
      <td>-0.11</td>
      <td>0.01</td>
      <td>-0.1</td>
      <td>-0.22*</td>
      <td>-0.17</td>
      <td>-0.17</td>
      <td>-0.16</td>
      <td>-0.2</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.74</td>
      <td>-0.13</td>
      <td>0.03</td>
      <td>-0.12</td>
      <td>-0.2*</td>
      <td>-0.15</td>
      <td>-0.14</td>
      <td>-0.14</td>
      <td>-0.16</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">DITMC</th>
      <th>long</th>
      <td>2.03</td>
      <td>-0.23</td>
      <td>-0.24</td>
      <td>-0.22</td>
      <td>-0.35*</td>
      <td>-0.25</td>
      <td>-0.25</td>
      <td>-0.26</td>
      <td>-0.33</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>2.14</td>
      <td>-0.17</td>
      <td>-0.16</td>
      <td>-0.16</td>
      <td>-0.27*</td>
      <td>-0.19</td>
      <td>-0.19</td>
      <td>-0.19</td>
      <td>-0.25</td>
    </tr>
    <tr>
      <th>short</th>
      <td>2.72</td>
      <td>-0.19</td>
      <td>-0.15</td>
      <td>-0.18</td>
      <td>-0.25*</td>
      <td>-0.18</td>
      <td>-0.17</td>
      <td>-0.18</td>
      <td>-0.2</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ITMC</th>
      <th>long</th>
      <td>0.71</td>
      <td>-0.15</td>
      <td>-0.2</td>
      <td>-0.13</td>
      <td>-0.28*</td>
      <td>-0.25</td>
      <td>-0.25</td>
      <td>-0.25</td>
      <td>-0.27</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>0.88</td>
      <td>-0.32</td>
      <td>-0.34</td>
      <td>-0.3</td>
      <td>-0.39*</td>
      <td>-0.33</td>
      <td>-0.32</td>
      <td>-0.32</td>
      <td>-0.34</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.35</td>
      <td>-0.29</td>
      <td>-0.27</td>
      <td>-0.28</td>
      <td>-0.32*</td>
      <td>-0.28</td>
      <td>-0.27</td>
      <td>-0.27</td>
      <td>-0.25</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ATMC</th>
      <th>long</th>
      <td>0.84</td>
      <td>-0.22</td>
      <td>-0.2</td>
      <td>-0.23</td>
      <td>-0.35*</td>
      <td>-0.27</td>
      <td>-0.27</td>
      <td>-0.27</td>
      <td>-0.32</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>0.97</td>
      <td>-0.29</td>
      <td>-0.24</td>
      <td>-0.3</td>
      <td>-0.38*</td>
      <td>-0.3</td>
      <td>-0.3</td>
      <td>-0.3</td>
      <td>-0.32</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.4</td>
      <td>-0.27</td>
      <td>-0.17</td>
      <td>-0.27</td>
      <td>-0.32*</td>
      <td>-0.26</td>
      <td>-0.26</td>
      <td>-0.26</td>
      <td>-0.25</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">OTMC</th>
      <th>long</th>
      <td>0.93</td>
      <td>-0.16</td>
      <td>-0.12</td>
      <td>-0.18</td>
      <td>-0.3*</td>
      <td>-0.23</td>
      <td>-0.23</td>
      <td>-0.23</td>
      <td>-0.28</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1.06</td>
      <td>-0.17</td>
      <td>-0.09</td>
      <td>-0.18</td>
      <td>-0.28*</td>
      <td>-0.22</td>
      <td>-0.22</td>
      <td>-0.22</td>
      <td>-0.25</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.48</td>
      <td>-0.18</td>
      <td>-0.05</td>
      <td>-0.18</td>
      <td>-0.24*</td>
      <td>-0.18</td>
      <td>-0.19</td>
      <td>-0.19</td>
      <td>-0.19</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">DOTMC</th>
      <th>long</th>
      <td>1.24</td>
      <td>-0.21</td>
      <td>-0.21</td>
      <td>-0.27</td>
      <td>-0.39*</td>
      <td>-0.3</td>
      <td>-0.29</td>
      <td>-0.3</td>
      <td>-0.37</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1.42</td>
      <td>-0.2</td>
      <td>-0.16</td>
      <td>-0.25</td>
      <td>-0.36*</td>
      <td>-0.27</td>
      <td>-0.27</td>
      <td>-0.27</td>
      <td>-0.32</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.77</td>
      <td>-0.13</td>
      <td>0.0</td>
      <td>-0.15</td>
      <td>-0.22*</td>
      <td>-0.17</td>
      <td>-0.17</td>
      <td>-0.17</td>
      <td>-0.18</td>
    </tr>
  </tbody>
</table>
</div>

<p>RMSE average each model</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tab<span style="color:#555">.</span>mean()<span style="color:#555">.</span>T</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">BG5N     1.45
BG5C1   -0.22
BG5C2   -0.19
BG5C3   -0.22
BG5C4   -0.32
BG5C5   -0.24
BG5C6   -0.25
BG5C7   -0.24
BG5C8   -0.28
dtype: float64</pre></div>
<h2 id="4-2-in-sample-rmse-time-series">4.2 In sample RMSE time series</h2>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ts <span style="color:#555">=</span> rmse<span style="color:#555">.</span>mean(level<span style="color:#555">=</span><span style="color:#f60">1</span>)
<span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> modsF[<span style="color:#f60">1</span>:]:
    ts[mod] <span style="color:#555">=</span> ts[mod]<span style="color:#555">/</span>ts[<span style="color:#c30">&#39;BG5N&#39;</span>]
ts[<span style="color:#c30">&#39;BG5N&#39;</span>] <span style="color:#555">=</span> <span style="color:#f60">1</span>
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">seaborn</span> <span style="color:#069;font-weight:bold">as</span> <span style="color:#0cf;font-weight:bold">sns</span>
sns<span style="color:#555">.</span><span style="color:#366">set</span>(context<span style="color:#555">=</span><span style="color:#c30">&#39;notebook&#39;</span>, style<span style="color:#555">=</span><span style="color:#c30">&#39;whitegrid&#39;</span>, palette<span style="color:#555">=</span><span style="color:#c30">&#39;Set2&#39;</span>)

sns<span style="color:#555">.</span>set_style(<span style="color:#c30">&#34;whitegrid&#34;</span>, {<span style="color:#c30">&#39;axes.grid&#39;</span> : False})
fig <span style="color:#555">=</span> plt<span style="color:#555">.</span>figure(figsize<span style="color:#555">=</span>(<span style="color:#f60">12</span>,<span style="color:#f60">5</span>))
ax <span style="color:#555">=</span> fig<span style="color:#555">.</span>add_subplot(<span style="color:#f60">111</span>)
ts[[<span style="color:#c30">&#39;BG5N&#39;</span>,<span style="color:#c30">&#39;BG5C1&#39;</span>,<span style="color:#c30">&#39;BG5C4&#39;</span>,<span style="color:#c30">&#39;BG5C8&#39;</span>]][::<span style="color:#f60">2</span>]<span style="color:#555">.</span>plot(ax<span style="color:#555">=</span>ax,linewidth<span style="color:#555">=</span><span style="color:#f60">0.9</span>)
ax<span style="color:#555">.</span>yaxis<span style="color:#555">.</span>grid(which<span style="color:#555">=</span><span style="color:#c30">&#34;major&#34;</span>, color<span style="color:#555">=</span><span style="color:#c30">&#39;#DCDCDC&#39;</span>, linestyle<span style="color:#555">=</span><span style="color:#c30">&#39;-&#39;</span>, linewidth<span style="color:#555">=</span><span style="color:#f60">0.5</span>)
sns<span style="color:#555">.</span>despine()</code></pre></div>
<p><img src="output_21_0.png" alt="png" /></p>

<h1 id="5-out-of-sample-fit">5. Out of Sample Fit</h1>

<h2 id="5-1-rmsfe-over-ivs">5.1 RMSFE over IVS</h2>

<p>RMSFE over entire surface</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#069;font-weight:bold">with</span> pd<span style="color:#555">.</span>HDFStore(<span style="color:#c30">&#39;OSFit.h5&#39;</span>,<span style="color:#c30">&#39;r&#39;</span>) <span style="color:#069;font-weight:bold">as</span> hdf:
    data <span style="color:#555">=</span> hdf[<span style="color:#c30">&#39;OSFit&#39;</span>]

models <span style="color:#555">=</span> [<span style="color:#c30">&#39;BG5&#39;</span>]
modsF <span style="color:#555">=</span> [mod <span style="color:#555">+</span> <span style="color:#c30">&#39;N1&#39;</span> <span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> models]
modsF <span style="color:#555">+=</span> [mod <span style="color:#555">+</span> <span style="color:#c30">&#39;C1&#39;</span> <span style="color:#555">+</span> <span style="color:#366">str</span>(i) <span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> models <span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(<span style="color:#f60">1</span>,<span style="color:#f60">9</span>)]
maturG <span style="color:#555">=</span> [<span style="color:#c30">&#39;short&#39;</span>,<span style="color:#c30">&#39;medium&#39;</span>,<span style="color:#c30">&#39;long&#39;</span>]
deltaG <span style="color:#555">=</span> [<span style="color:#c30">&#39;DOTMP&#39;</span>,<span style="color:#c30">&#39;OTMP&#39;</span>,<span style="color:#c30">&#39;ATMP&#39;</span>,<span style="color:#c30">&#39;ITMP&#39;</span>,<span style="color:#c30">&#39;DITMP&#39;</span>,<span style="color:#c30">&#39;DITMC&#39;</span>,<span style="color:#c30">&#39;ITMC&#39;</span>,<span style="color:#c30">&#39;ATMC&#39;</span>,<span style="color:#c30">&#39;OTMC&#39;</span>,<span style="color:#c30">&#39;DOTMC&#39;</span>]
<span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> modsF:
    data[mod] <span style="color:#555">=</span> data<span style="color:#555">.</span><span style="color:#366">eval</span>(<span style="color:#c30">&#34;(imvol-</span><span style="color:#a00">%s</span><span style="color:#c30">)**2&#34;</span><span style="color:#555">%</span>(mod))
rmse <span style="color:#555">=</span> np<span style="color:#555">.</span>sqrt(data<span style="color:#555">.</span>groupby([<span style="color:#c30">&#39;ticker&#39;</span>,<span style="color:#c30">&#39;date&#39;</span>,<span style="color:#c30">&#39;delta_groups&#39;</span>,<span style="color:#c30">&#39;mat_groups&#39;</span>])[modsF]<span style="color:#555">.</span>mean())
tab <span style="color:#555">=</span> rmse<span style="color:#555">.</span>mean(level<span style="color:#555">=</span>[<span style="color:#f60">2</span>,<span style="color:#f60">3</span>])<span style="color:#555">*</span><span style="color:#f60">100</span>
<span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> modsF[<span style="color:#f60">1</span>:]:
    tab[mod] <span style="color:#555">=</span> (tab[mod]<span style="color:#555">-</span>tab[<span style="color:#c30">&#39;BG5N1&#39;</span>])<span style="color:#555">/</span>tab[<span style="color:#c30">&#39;BG5N1&#39;</span>]
tabs <span style="color:#555">=</span> tab<span style="color:#555">.</span><span style="color:#366">round</span>(<span style="color:#f60">2</span>)<span style="color:#555">.</span>astype(<span style="color:#366">str</span>)

modmin <span style="color:#555">=</span> {}
<span style="color:#069;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#366">range</span>(tab<span style="color:#555">.</span>shape[<span style="color:#f60">0</span>]):
    modmin[i] <span style="color:#555">=</span> tab<span style="color:#555">.</span>iloc[i,:]<span style="color:#555">.</span>argmin()
    tabs<span style="color:#555">.</span>iloc[i,:]<span style="color:#555">.</span>loc[modmin[i]] <span style="color:#555">+=</span> <span style="color:#c30">&#39;**&#39;</span>

tabs<span style="color:#555">.</span>T[deltaG]<span style="color:#555">.</span>T</code></pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>BG5N1</th>
      <th>BG5C11</th>
      <th>BG5C12</th>
      <th>BG5C13</th>
      <th>BG5C14</th>
      <th>BG5C15</th>
      <th>BG5C16</th>
      <th>BG5C17</th>
      <th>BG5C18</th>
    </tr>
    <tr>
      <th>delta_groups</th>
      <th>mat_groups</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">DOTMP</th>
      <th>long</th>
      <td>1.78</td>
      <td>-0.27</td>
      <td>-0.37</td>
      <td>-0.32</td>
      <td>-0.2</td>
      <td>-0.38</td>
      <td>-0.39</td>
      <td>-0.39</td>
      <td>-0.45**</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>2.17</td>
      <td>-0.34</td>
      <td>-0.41</td>
      <td>-0.37</td>
      <td>-0.24</td>
      <td>-0.4</td>
      <td>-0.41</td>
      <td>-0.41</td>
      <td>-0.46**</td>
    </tr>
    <tr>
      <th>short</th>
      <td>2.72</td>
      <td>-0.38</td>
      <td>-0.45**</td>
      <td>-0.41</td>
      <td>-0.27</td>
      <td>-0.39</td>
      <td>-0.41</td>
      <td>-0.41</td>
      <td>-0.43</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">OTMP</th>
      <th>long</th>
      <td>1.03</td>
      <td>-0.35</td>
      <td>-0.37</td>
      <td>-0.36</td>
      <td>-0.2</td>
      <td>-0.41</td>
      <td>-0.43</td>
      <td>-0.43</td>
      <td>-0.44**</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1.15</td>
      <td>-0.37</td>
      <td>-0.37</td>
      <td>-0.38</td>
      <td>-0.19</td>
      <td>-0.41</td>
      <td>-0.42</td>
      <td>-0.42</td>
      <td>-0.43**</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.87</td>
      <td>-0.53</td>
      <td>-0.53**</td>
      <td>-0.53</td>
      <td>-0.37</td>
      <td>-0.45</td>
      <td>-0.47</td>
      <td>-0.47</td>
      <td>-0.48</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ATMP</th>
      <th>long</th>
      <td>0.73</td>
      <td>-0.44</td>
      <td>-0.52**</td>
      <td>-0.46</td>
      <td>-0.4</td>
      <td>-0.47</td>
      <td>-0.48</td>
      <td>-0.48</td>
      <td>-0.5</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>0.89</td>
      <td>-0.53</td>
      <td>-0.59**</td>
      <td>-0.55</td>
      <td>-0.47</td>
      <td>-0.49</td>
      <td>-0.51</td>
      <td>-0.51</td>
      <td>-0.53</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.37</td>
      <td>-0.59</td>
      <td>-0.65**</td>
      <td>-0.6</td>
      <td>-0.48</td>
      <td>-0.47</td>
      <td>-0.49</td>
      <td>-0.49</td>
      <td>-0.47</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ITMP</th>
      <th>long</th>
      <td>0.88</td>
      <td>-0.46</td>
      <td>-0.54</td>
      <td>-0.42</td>
      <td>-0.43</td>
      <td>-0.47</td>
      <td>-0.49</td>
      <td>-0.44</td>
      <td>-0.54**</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>0.99</td>
      <td>-0.5</td>
      <td>-0.56**</td>
      <td>-0.46</td>
      <td>-0.46</td>
      <td>-0.48</td>
      <td>-0.5</td>
      <td>-0.45</td>
      <td>-0.53</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.41</td>
      <td>-0.51</td>
      <td>-0.61**</td>
      <td>-0.46</td>
      <td>-0.45</td>
      <td>-0.45</td>
      <td>-0.47</td>
      <td>-0.42</td>
      <td>-0.45</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">DITMP</th>
      <th>long</th>
      <td>1.34</td>
      <td>-0.41</td>
      <td>-0.55**</td>
      <td>-0.33</td>
      <td>-0.32</td>
      <td>-0.42</td>
      <td>-0.44</td>
      <td>-0.39</td>
      <td>-0.33</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1.53</td>
      <td>-0.43</td>
      <td>-0.56**</td>
      <td>-0.35</td>
      <td>-0.34</td>
      <td>-0.42</td>
      <td>-0.45</td>
      <td>-0.4</td>
      <td>-0.33</td>
    </tr>
    <tr>
      <th>short</th>
      <td>2.01</td>
      <td>-0.43</td>
      <td>-0.57**</td>
      <td>-0.35</td>
      <td>-0.36</td>
      <td>-0.41</td>
      <td>-0.43</td>
      <td>-0.38</td>
      <td>-0.31</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">DITMC</th>
      <th>long</th>
      <td>2.32</td>
      <td>-0.37</td>
      <td>-0.62**</td>
      <td>-0.35</td>
      <td>-0.38</td>
      <td>-0.44</td>
      <td>-0.44</td>
      <td>-0.43</td>
      <td>-0.39</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>2.49</td>
      <td>-0.33</td>
      <td>-0.59**</td>
      <td>-0.31</td>
      <td>-0.33</td>
      <td>-0.4</td>
      <td>-0.41</td>
      <td>-0.4</td>
      <td>-0.33</td>
    </tr>
    <tr>
      <th>short</th>
      <td>3.24</td>
      <td>-0.4</td>
      <td>-0.64**</td>
      <td>-0.38</td>
      <td>-0.38</td>
      <td>-0.42</td>
      <td>-0.43</td>
      <td>-0.41</td>
      <td>-0.33</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ITMC</th>
      <th>long</th>
      <td>0.69</td>
      <td>-0.4</td>
      <td>-0.5**</td>
      <td>-0.38</td>
      <td>-0.33</td>
      <td>-0.46</td>
      <td>-0.47</td>
      <td>-0.46</td>
      <td>-0.43</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>0.86</td>
      <td>-0.48</td>
      <td>-0.58**</td>
      <td>-0.46</td>
      <td>-0.42</td>
      <td>-0.49</td>
      <td>-0.5</td>
      <td>-0.48</td>
      <td>-0.47</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.46</td>
      <td>-0.56</td>
      <td>-0.68**</td>
      <td>-0.55</td>
      <td>-0.46</td>
      <td>-0.47</td>
      <td>-0.49</td>
      <td>-0.46</td>
      <td>-0.43</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">ATMC</th>
      <th>long</th>
      <td>0.76</td>
      <td>-0.44</td>
      <td>-0.48</td>
      <td>-0.46</td>
      <td>-0.35</td>
      <td>-0.48</td>
      <td>-0.5</td>
      <td>-0.49</td>
      <td>-0.52**</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>0.89</td>
      <td>-0.49</td>
      <td>-0.52</td>
      <td>-0.5</td>
      <td>-0.4</td>
      <td>-0.5</td>
      <td>-0.52</td>
      <td>-0.51</td>
      <td>-0.53**</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.39</td>
      <td>-0.57</td>
      <td>-0.61**</td>
      <td>-0.58</td>
      <td>-0.45</td>
      <td>-0.49</td>
      <td>-0.51</td>
      <td>-0.51</td>
      <td>-0.48</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">OTMC</th>
      <th>long</th>
      <td>0.82</td>
      <td>-0.36</td>
      <td>-0.34</td>
      <td>-0.38</td>
      <td>-0.26</td>
      <td>-0.44</td>
      <td>-0.45</td>
      <td>-0.45</td>
      <td>-0.47**</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>0.91</td>
      <td>-0.4</td>
      <td>-0.35</td>
      <td>-0.41</td>
      <td>-0.27</td>
      <td>-0.45</td>
      <td>-0.47**</td>
      <td>-0.46</td>
      <td>-0.46</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.37</td>
      <td>-0.48</td>
      <td>-0.44</td>
      <td>-0.49**</td>
      <td>-0.34</td>
      <td>-0.45</td>
      <td>-0.47</td>
      <td>-0.46</td>
      <td>-0.44</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">DOTMC</th>
      <th>long</th>
      <td>1.15</td>
      <td>-0.36</td>
      <td>-0.41</td>
      <td>-0.43</td>
      <td>-0.39</td>
      <td>-0.48</td>
      <td>-0.47</td>
      <td>-0.48</td>
      <td>-0.53**</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1.3</td>
      <td>-0.38</td>
      <td>-0.41</td>
      <td>-0.44</td>
      <td>-0.39</td>
      <td>-0.47</td>
      <td>-0.47</td>
      <td>-0.48</td>
      <td>-0.52**</td>
    </tr>
    <tr>
      <th>short</th>
      <td>1.7</td>
      <td>-0.37</td>
      <td>-0.37</td>
      <td>-0.42</td>
      <td>-0.33</td>
      <td>-0.42</td>
      <td>-0.43**</td>
      <td>-0.43</td>
      <td>-0.41</td>
    </tr>
  </tbody>
</table>
</div>

<p>RMSE average each model</p>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tab<span style="color:#555">.</span>mean()<span style="color:#555">.</span>T</code></pre></div><div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4">BG5N1     1.44
BG5C11   -0.43
BG5C12   -0.51
BG5C13   -0.43
BG5C14   -0.36
BG5C15   -0.45
BG5C16   -0.46
BG5C17   -0.45
BG5C18   -0.45
dtype: float64</pre></div>
<h2 id="5-2-rmsfe-time-series">5.2 RMSFE time series</h2>
<div class="highlight"><pre style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ts <span style="color:#555">=</span> rmse<span style="color:#555">.</span>mean(level<span style="color:#555">=</span><span style="color:#f60">1</span>)
<span style="color:#069;font-weight:bold">for</span> mod <span style="color:#000;font-weight:bold">in</span> modsF[<span style="color:#f60">1</span>:]:
    ts[mod] <span style="color:#555">=</span> ts[mod]<span style="color:#555">/</span>ts[<span style="color:#c30">&#39;BG5N1&#39;</span>]
ts[<span style="color:#c30">&#39;BG5N1&#39;</span>] <span style="color:#555">=</span> <span style="color:#f60">1</span>
<span style="color:#069;font-weight:bold">import</span> <span style="color:#0cf;font-weight:bold">seaborn</span> <span style="color:#069;font-weight:bold">as</span> <span style="color:#0cf;font-weight:bold">sns</span>
sns<span style="color:#555">.</span><span style="color:#366">set</span>(context<span style="color:#555">=</span><span style="color:#c30">&#39;notebook&#39;</span>, style<span style="color:#555">=</span><span style="color:#c30">&#39;whitegrid&#39;</span>, palette<span style="color:#555">=</span><span style="color:#c30">&#39;Set2&#39;</span>)

sns<span style="color:#555">.</span>set_style(<span style="color:#c30">&#34;whitegrid&#34;</span>, {<span style="color:#c30">&#39;axes.grid&#39;</span> : False})
fig <span style="color:#555">=</span> plt<span style="color:#555">.</span>figure(figsize<span style="color:#555">=</span>(<span style="color:#f60">12</span>,<span style="color:#f60">5</span>))
ax <span style="color:#555">=</span> fig<span style="color:#555">.</span>add_subplot(<span style="color:#f60">111</span>)
ts[[<span style="color:#c30">&#39;BG5N1&#39;</span>,<span style="color:#c30">&#39;BG5C12&#39;</span>,<span style="color:#c30">&#39;BG5C14&#39;</span>,<span style="color:#c30">&#39;BG5C18&#39;</span>]][::<span style="color:#f60">2</span>]<span style="color:#555">.</span>plot(ax<span style="color:#555">=</span>ax,linewidth<span style="color:#555">=</span><span style="color:#f60">0.9</span>)
ax<span style="color:#555">.</span>yaxis<span style="color:#555">.</span>grid(which<span style="color:#555">=</span><span style="color:#c30">&#34;major&#34;</span>, color<span style="color:#555">=</span><span style="color:#c30">&#39;#DCDCDC&#39;</span>, linestyle<span style="color:#555">=</span><span style="color:#c30">&#39;-&#39;</span>, linewidth<span style="color:#555">=</span><span style="color:#f60">0.5</span>)
sns<span style="color:#555">.</span>despine()</code></pre></div>
<p><img src="output_28_0.png" alt="png" /></p>

    
    
  </div>
</section>


        </div>
        


<script src="https://gongmichael.github.io/michaelgongcom/vendor/jquery/jquery.min.js"></script>
<script src="https://gongmichael.github.io/michaelgongcom/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>


<script src="https://gongmichael.github.io/michaelgongcom/vendor/jquery-easing/jquery.easing.min.js"></script>
<script src="https://gongmichael.github.io/michaelgongcom/vendor/scrollreveal/scrollreveal.min.js"></script>
<script src="https://gongmichael.github.io/michaelgongcom/vendor/magnific-popup/jquery.magnific-popup.min.js"></script>


<script src="https://gongmichael.github.io/michaelgongcom/js/creative.js"></script>




    
</body>
</html>










